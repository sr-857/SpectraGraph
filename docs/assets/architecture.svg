<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="780" viewBox="0 0 1200 780">
  <style>
    .bg{fill:#071028}
    .node{fill:#0b1a2b;stroke:#0ea5df;stroke-width:2;rx:12;}
    .boxTitle{fill:#7dd3fc;font-weight:700;font-size:14px}
    .label{fill:#e6f7ff;font-size:13px}
    .small{fill:#a8d8ea;font-size:11px}
    .arrow{stroke:#06b6d4;stroke-width:2;marker-end:url(#arrowhead)}
    .dashed{stroke-dasharray:6 6;stroke:#38bdf8;opacity:0.7}
    .cloud{fill:#061425;stroke:#0891b2;stroke-width:1}
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#06b6d4" />
    </marker>
  </defs>
  <rect class="bg" x="0" y="0" width="1200" height="780" />

  <!-- Frontend -->
  <g transform="translate(40,40)">
    <rect class="node" x="0" y="0" width="260" height="70" rx="10"/>
    <text x="18" y="24" class="boxTitle">Frontend</text>
    <text x="18" y="46" class="label">Vite / React • Dashboard • WS/REST</text>
  </g>

  <!-- API -->
  <g transform="translate(360,40)">
    <rect class="node" x="0" y="0" width="300" height="100" rx="12"/>
    <text x="18" y="26" class="boxTitle">API (FastAPI)</text>
    <text x="18" y="48" class="label">REST, WebSockets, Auth</text>
    <text x="18" y="68" class="small">Routers: investigations, transforms, health</text>
  </g>

  <!-- Core / Orchestrator -->
  <g transform="translate(740,40)">
    <rect class="node" x="0" y="0" width="360" height="160" rx="12"/>
    <text x="18" y="26" class="boxTitle">Core (Orchestrator)</text>
    <text x="18" y="48" class="label">Celery bootstrap • Vault • Graph clients</text>
    <text x="18" y="68" class="small">Transform lifecycle: init → preprocess → scan → normalize</text>
    <text x="18" y="88" class="small">Task routing, retries, rate limits</text>
  </g>

  <!-- Transforms -->
  <g transform="translate(360,220)">
    <rect class="node" x="0" y="0" width="300" height="140" rx="12"/>
    <text x="18" y="26" class="boxTitle">Transforms (OSINT Enrichers)</text>
    <text x="18" y="48" class="label">Domain, IP, Phone, Email, Social, Crypto</text>
    <text x="18" y="68" class="small">params_schema • vault secrets • evidence</text>
    <text x="18" y="88" class="small">preprocess(), scan(), normalize()</text>
  </g>

  <!-- Types -->
  <g transform="translate(740,240)">
    <rect class="node" x="0" y="0" width="260" height="90" rx="12"/>
    <text x="18" y="26" class="boxTitle">Types (Pydantic Models)</text>
    <text x="18" y="48" class="label">Domain, IP, Breach, Entity…</text>
    <text x="18" y="68" class="small">Shared schemas for API/Core/Transforms</text>
  </g>

  <!-- Datastores -->
  <g transform="translate(40,420)">
    <rect class="cloud" x="0" y="0" width="200" height="60" rx="8"/>
    <text x="16" y="28" class="boxTitle">Postgres</text>
    <text x="16" y="46" class="small">Relational storage • Entities • Audit</text>
  </g>

  <g transform="translate(280,420)">
    <rect class="cloud" x="0" y="0" width="200" height="60" rx="8"/>
    <text x="16" y="28" class="boxTitle">Neo4j</text>
    <text x="16" y="46" class="small">Graph index • Entity links</text>
  </g>

  <g transform="translate(520,420)">
    <rect class="cloud" x="0" y="0" width="200" height="60" rx="8"/>
    <text x="16" y="28" class="boxTitle">Redis (Broker)</text>
    <text x="16" y="46" class="small">Celery broker • Cache • Pub/Sub</text>
  </g>

  <!-- Worker Pool -->
  <g transform="translate(800,420)">
    <rect class="node" x="0" y="0" width="300" height="120" rx="12"/>
    <text x="18" y="26" class="boxTitle">Worker Pool</text>
    <text x="18" y="50" class="label">Celery Workers • Async Executors</text>
    <text x="18" y="70" class="small">Retries • concurrency • backoff</text>
  </g>

  <!-- Vault -->
  <g transform="translate(40,540)">
    <rect class="node" x="0" y="0" width="200" height="80" rx="12"/>
    <text x="18" y="26" class="boxTitle">Vault</text>
    <text x="18" y="50" class="small">Secrets store • API keys</text>
  </g>

  <!-- Arrows -->
  <line x1="300" y1="75" x2="360" y2="75" class="arrow"/>
  <line x1="660" y1="75" x2="740" y2="75" class="arrow"/>

  <line x1="510" y1="220" x2="660" y2="220" class="arrow"/>
  <line x1="860" y1="290" x2="860" y2="420" class="arrow"/>

  <line x1="420" y1="260" x2="420" y2="360" class="arrow"/>
  <line x1="760" y1="300" x2="760" y2="360" class="arrow"/>

  <line x1="180" y1="480" x2="180" y2="420" class="arrow"/>
  <line x1="400" y1="480" x2="400" y2="420" class="arrow"/>
  <line x1="640" y1="480" x2="640" y2="420" class="arrow"/>

  <line x1="620" y1="120" x2="620" y2="240" class="dashed"/>
  <text x="640" y="140" class="small">enqueues</text>

  <!-- WS / REST -->
  <path d="M 120 40 Q 200 0 360 40" fill="none" stroke="#7dd3fc" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="20" y="20" class="small">User Browser</text>

  <!-- Footer label -->
  <text x="20" y="760" class="small">SpectraGraph architecture • Generated SVG • Ready for docs/assets/architecture.svg</text>
</svg>
